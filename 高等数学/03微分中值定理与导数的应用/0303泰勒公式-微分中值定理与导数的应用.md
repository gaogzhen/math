[TOC]



## 1 引入

对于一些复杂函数，我们希望用一些简单的函数（幂函数-多项式函数）来近似表达。

前面我们在学习微分时，有$f(x)=f(x_0)+f^{'}(x_0)(x-x_0)+o(x-x_0)$（误差）

$\Rightarrow f(x)\approx f(x_0)+f^{'}(x_0)(x-x_0)$

但是这种近似有缺点：

1. 近似精确度不高
2. 有误差，无法估计



## 2 泰勒中值定理

### 2.1 泰勒多项式

设函数$f(x)在x_0$处有n阶导数，试找出一个关于$(x-x_0)的n$次多项式

$p_n(x)=a_0+a_1(x-x_0)+a_2(x-x_0)^2+\cdots+a_n(x-x_0)^n$    (3-1)

来近似表达$f(x)$要求$P_n(x)与f(x)$之差是当$x\to x_0时比(x-x_0)^n$高阶的无穷小。

要满足上述要求，我们假设$P_n(x)在x_0$处的函数值及它直到n阶导数在$x_0$处的值依次与$f(x_0),f^{'}(x_0),\cdots,f^{(n)}(x_0)$相等，即

$p_n(x_0)=f(x_0),P^{'}_n(x_0)=f^{'}(x_0),P^{''}_n(x_0)=f^{''}(x_0),\cdots,P^{(n)}_n(x_0)=f^{(n)}(x_0)$

对（3-1）式求各阶导数，导入上式得

$a_0=f(x_0),a_1=f^{'}(x_0),a_2=\frac{f^{'}(x_0)}{2!},\cdots,a_n=\frac{f^{(n)}(x_0)}{n!}$

$p_n(x)=f(x_0)+f^{'}(x_0)(x-x_0)+\frac{f^{'}(x_0)}{2!}(x-x_0)^2+\cdots+\frac{f^{(n)}(x_0)}{n!}(x-x_0)^n$   (3-2)

下面的定理表明，多项式（3-2）的确是我们要找的n次多项式。

### 3.2 泰勒中值定理1

> 如果函数$f(x)在x_0处具有n$阶导数，那么存在$x_0$的一个邻域，对于改邻域内的任一$x$,有
>
> $f(x)=f(x_0)+f^{'}(x_0)(x-x_0)+\frac{f^{'}(x_0)}{2!}(x-x_0)^2+\cdots+\frac{f^{(n)}(x_0)}{n!}(x-x_0)^n+R_n(x)$   (3-3)
>
> 其中$R_n(x)=o((x-x_0)^n)$  (3-4)

$$
证明： \\
记R_n(x)=f(x)-P_n(x),则 \\
R_n(x_0)=R_n^{'}(x_0)=R^{''}(x_0)=\cdots=R^{(n)}(x_0)=0 \\
由于f(x)在x_0处具有你阶导数，从而R_n(x)也在该邻域内n阶可导，反复应用洛必达法则，得 \\
\lim\limits_{x\to x_0}\frac{R_n(x)}{(x-x_0)^n}=\lim\limits_{x\to x_0}\frac{R_n^{'}(x)}{n(x-x_0)^{n-1}}=\lim\limits_{x\to x_0}\frac{R_n^{'}(x)}{n(x-x_0)^{n-1}} \\
=\cdots=\lim\limits_{x\to x_0}\frac{R_n^{(n-1)}(x)}{n!(x-x_0)}=\frac{1}{n!}R^{(n)}(x_0)=0 \\
因此R_n(x)=o((x-x_0)^n)
$$

注：

1. $R_n(x)=o((x-x_0)^n)称为f(x)在x_0处$的佩亚诺余项

### 3.3 泰勒中值定理2

> 如果函数$f(x)$在$x_0$的某个邻域$U(x_0)$内具有$(n+1)$阶导数，那么对于任一$x\in U(x_0)$，有
>
> $f(x)=f(x_0)+f^{'}(x_0)(x-x_0)+\frac{f^{'}(x_0)}{2!}(x-x_0)^2+\cdots+\frac{f^{(n)}(x_0)}{n!}(x-x_0)^n+R_n(x)$   (3-5)
>
> 其中$R_n(x)=\frac{f^{(n+1)}(\xi)}{(n+1)!}(x-x_0)^{n+1}$  (3-6)
>
> 这里$\xi是x与x_0$直接的某个值

$$
证明：\\
记R_n(x)=f(x)-P_n(x),则 \\
只需证明R_n(x)=\frac{f^{(n+1)}(\xi)}{(n+1)!}(x-x_0)^{n+1} \\
由假设可知\quad R_n(x_0)=R_n^{'}(x_0)=R^{''}(x_0)=\cdots=R^{(n)}(x_0)=0 \\
对于2个函数Rn(x)及(x-x_0)^{n+1}在以x_0和x为端点的区间上应用柯西中值定理（这2个函数满足柯西中值定理条件） \\
\frac{Rn(x)}{(x-x_0)^{n+1}}=\frac{Rn(x)-Rn(x_0)}{(x-x_0)^{n+1}-(x_0-x_0)^{n+1}} \\
=\frac{Rn^{'}(\xi_1)}{(n+1)(\xi_1-x_0)^{n}}(\xi_1在x_0与x之间) \\
在对这2个函数以\xi_1和x_0为端点的区间应用柯西中值定理 \\
\frac{Rn^{'}(\xi_1)}{(n+1)(\xi_1-x_0)^{n}}=\frac{Rn^{'}(\xi_1)-Rn^{'}(x_0)}{(n+1)(\xi_1-x_0)^{n}-(n+1)(x_0-x_0)^{n}} \\
=\frac{Rn^{''}(\xi_2)}{(n+1)n(\xi_2-x_0)^{n-1}}(\xi_2在\xi_1与x_0之间) \\
重复应用柯西中值定理，经过(n+1)次后，得 \\
\frac{Rn(x)}{(x-x_0)^{n+1}}=\frac{Rn^{(n+1)}(\xi)}{(n+1)!}(\xi在\xi_n与x_0之间，因此也在x_0与x之间) \\
Rn^{(n+1)}(\xi)=[f(\xi)-Pn(\xi)]^{(n+1)}=f^{(n+1)(\xi)}-Pn^{(n+1)(\xi)} \\
其中Pn^{(n)}(x)为常数，Pn^{(n+1)(\xi)}=0 \\
所以Rn^{(n+1)}(\xi)=f^{(n+1)(\xi)} 即\\
R_n(x)=\frac{f^{(n+1)}(\xi)}{(n+1)!}(x-x_0)^{n+1}(\xi在x_0与x之间)
$$

注：

1. 该公式称为$f(x)在x_0$处带有拉格朗日型余项的n阶泰勒公式
2. 也称为将$f(x)在x_0$处展成带有拉格朗日型余项的n阶泰勒公式或称为$f(x)按(x-x_0)$的幂展成带有拉格朗日型余项的n阶泰勒公式
3. $n=0时，f(x)=f(x_0)+f^{'}(\xi)(x-x_0)$,即为拉格朗日中值定理公式

### 2.4 误差估计

由泰勒中值定理2知，我们用Pn(x)近似表达函数$f(x)$时，其误差为$|Rn(x)|$。如果对于某个固定的n，当$x\in U(x_0)时，|f^{(n+1)}(x)|\le M$,那么有估计式

$|Rn(x)|=|\frac{f^{(n+1)}(\xi)}{(n+1)!}(x-x_0)^{n+1}|\le\frac{M}{(n+1)!}(|x-x_0|)^{n+1}$

## 4 麦克劳林公式

如果取$x_0=0$,那么泰勒公式变为：
$$
f(x)=f(0)+f^{'}(0)\cdot x+\frac{f^{'}(0)}{2!}x^2+\cdots+\frac{f^{(n)}(0)}{n!}x^n+R_n(x) \\
Rn(x)=
\begin{cases}
o(x^n)\quad 佩亚诺型余项 \\
\frac{f^{n+1}(\xi)}{(n+1)!}x^{n+1}(\xi在x_0与x之间)\quad 拉格朗日型余项 \\
\end{cases}
$$
此公式称为$f(x)的n阶$麦克劳林公式。

注：

1. $\xi$可以写成$\theta x(0\lt\theta\lt1)$
2. 相应的误差估计：$|Rn(x)|\le\frac{M}{(n+1)!}|x|^{n+1}$
3. 麦克劳林公式函数$f(x)按x的幂$展开



## 5 常见麦克劳林公式

$$
e^x=1+x+\frac{x^2}{2!}+\cdots+\frac{x^n}{n!}+\frac{e^{\theta x}}{(n+1)!}(o(x^n )) \\
\sin x=x-\frac{x^3}{3!}+\frac{x^5}{5!}-\cdots+(-1)^{m-1}\frac{x^{2m-1}}{(2m-1)!}+(-1)^m\frac{\cos\theta x}{(2m+1)!}x^{2m+1} (o(x^{2m-1}))\\
\cos x=1-\frac{x^2}{2!}+\frac{x^4}{4!}-\cdots+(-1)^m\frac{x^{2m}}{(2m)!}+(-1)^{m+1}\frac{\cos\theta x}{(2m+2)!}x^{2m+2}(o(x^{2m})) \\
\ln(1+x)=x-\frac{x^2}{2!}+\frac{x^3}{3!}-\cdots+(-1)^{n-1}\frac{x^n}{n!}+\frac{(-1)^n}{(n+1)(1+\theta x)^{n+1}}(o(x^n)) \\
(1+x)^{\alpha}=1+\alpha x+\frac{\alpha(\alpha-1)}{2!}x^2+\cdots+\frac{\alpha(\alpha-1)\cdots(\alpha-n+1)}{n!}x^n+\frac{\alpha(\alpha-1)\cdots(\alpha-n)}{(n+1)!}(1+\theta x)^{\alpha-n-1}x^{n+1}(o(x^n)) \\
$$

## 6 泰勒公式相关例题

### 6.1 将函数展成指定的泰勒公式

#### 6.1.1 公式法

直接利用泰勒公式或者麦克劳林公式 

#### 6.1.2 间接展法（变量替换）

$f(x)=f(0)+f^{'}(0)\cdot x+\frac{f^{'}(0)}{2!}x^2+\cdots+\frac{f^{(n)}(0)}{n!}x^n+R_n(x)$

$f[g(x)]=f(0)+f^{'}(0)\cdot g(x)+\frac{f^{'}(0)}{2!}g^2(x)+\cdots+\frac{f^{(n)}(0)}{n!}g^n(x)+R_n[g(x)]	$



例2 

1）将$f(x)=e^{2x}$展成佩亚诺型余项的n阶麦克劳林公式
$$
解：e^x=1+x+\frac{x^2}{2!}+\cdots+\frac{x^n}{n!}+o(x^n ) \\
用2x替换x后仍然是关于x的幂的展开式即麦克劳林公式，所以直接替换，得 \\
e^{2x}=1+2x+\frac{(2x)^2}{2!}+\cdots+\frac{(2x)^n}{n!}+o(x^n )\\
=e^x=1+2x+\frac{2^2}{2!}x^2+\cdots+\frac{2^n}{n!}x^n+o(x^n )
$$
2)把$f(x)=e^x在x=1$处展成佩亚诺型余项的n阶泰勒公式
$$
解：我们知道e^x的n阶麦克劳林公式，但是需要展成(x-1)的幂的多项式 \\
e^x=e^{1+(x-1)}=e\cdot e^{x-1}=e[1+(x-1)+\frac{(x-1)^2}{2!}+\cdots+\frac{(x-1)^n}{n!}+o((x-1)^n )] \\
=e+e(x-1)+\frac{e}{2!}(x-1)^2+\cdots+\frac{e}{n!}(x-1)^n+o((x-1)^n )
$$

+ 也可以直接利用公式带入

3）把$f(x)=x\cdot\ln(2+x)$展成n阶麦克劳林公式
$$
解：已知\ln(1+x)=x-\frac{x^2}{2!}+\frac{x^3}{3!}-\cdots+(-1)^{n-1}\frac{x^n}{n!}+o(x^n) \\
如果\ln(2+x)=\ln[1+(1+x)]带入展开是(1+x)的幂的多项式即f(x)在-1处的泰勒公式不是麦克劳林公式 \\
此时\ln(2+x)=\ln[2(1+\frac{1}{2}x)]=\ln2+\ln(1+\frac{1}{2}x) \\
因为f(x)=x\cdot\ln(2+x)，所以\ln(1+\frac{1}{2}x)展成n-1阶即可,得 \\
\ln(1+\frac{1}{2}x)=\frac{1}{2}x-\frac{x^2}{2^2\cdot2!}+\frac{x^3}{2^3\cdot3!}-\cdots+(-1)^{n-2}\frac{x^{n-1}}{2^{n-1}(n-1)!}+o(x^{n-1}) \\
f(x)=x[\ln2+\ln(1+\frac{1}{2}x)]=x\ln2+\frac{1}{2}x^2-\frac{x^3}{2^2\cdot2!}+\frac{x^4}{2^3\cdot3!}-\cdots+(-1)^{n-2}\frac{x^{n}}{2^{n-1}(n-1)!}+o(x^{n})
$$

### 6.2 利用泰勒公式求极限

+ 无穷小的运算

$o(x^n)\pm o(x^n)=o(x^n)\quad o(x^n)+o(x^k)=o(x^n)(k\lt n)$

$m.o(x^n)=o(mx^n)=o(x^n)(m为常数)$

$x^k.o(x^n)=o(x^{n+k}) \quad o(x^k).o(x^n)=o(x^{n+k})$

$\frac{o(x^n)}{x^k}=o(x^{n-k})(k\lt n)$



例3 求极限$\lim\limits_{x\to0}{\frac{\cos x-e^{-\frac{x^2}{2}}}{\sin^4 x}}$
$$
解：当x\to0时,有\\
\sin^4x\backsim x^4 ,那么分子展成4阶泰勒公式\\
\cos x=1-\frac{x^2}{2!}+\frac{x^4}{4!}+o(x^4) \\
e^{-\frac{x^2}{2}}=1+(-\frac{x^2}{2})+\frac{(-\frac{x^2}{2})^2}{2!}+o(x^4) \\
\cos x-e^{-\frac{x^2}{2}}=\frac{1}{6}x^4+o(x^4) \\
所以\lim\limits_{x\to0}{\frac{\cos x-e^{-\frac{x^2}{2}}}{\sin^4 x}}=\lim\limits_{x\to0}{\frac{\frac{1}{6}x^4+o(x^4)}{x^4}}=\frac{1}{6}
$$
注：

1. 利用泰勒公式求极限就是用多项式+余项代替复杂公式，进而求多项式+余项的极限的思想

2. 那么泰勒公式要展成几阶呢？（观察分子、分母的最低次幂）

3. 要注意与等价无穷小代换，有理化等结合使用

    

### 6.3 确定无穷小的阶数

> 若$f(x)=a_jx^k+a_{j+1}x^{k+1}+\cdots+a_mx^n,(a_j\not=0,k\lt n)$,
>
> 则当$x\to0$时，有$f(x)\backsim a_{j}x^k$
>
> 即$f(x)是x的k阶无穷小$

$$
证明：
\lim\limits_{x\to0}{\frac{f(x)}{a_jx^k}}=\lim\limits_{x\to0}{\frac{a_jx^k+a_{j+1}x^{k+1}+\cdots+a_mx^n}{a_jx^k}} \\
=\lim\limits_{x\to0}{(1+\frac{a_{j+1}}{a_j}x+\frac{a_{j+2}}{a_j}x^2+\cdots+\frac{a_m}{a_j}x^{n-k})}=1 \\
即f(x)\backsim a_jx^k或f(x)是x的k阶无穷小
$$

例4 试确定$a,b,使f(x)=x-(a+b\cos x)\sin x,当x\to0$时是关于$x的5$阶无穷小。
$$
解：化简f(x) \\
f(x)=x-(a+b\cos x)\sin x=x-a\sin x-b\sin x\cos x=x-a\sin x-\frac{b}{2}\sin 2x \\
把f(x)展成5阶麦克劳林公式，得\\
f(x)=x-a(x-\frac{x^3}{3!}+\frac{x^5}{5!}+o(x^5))-\frac{b}{2}(2x-\frac{2^3x^3}{3!}+\frac{2^5x^5}{5!}+o(x^5)) \\
=(1-a-b)x+\frac{a+4b}{3!}x^3-\frac{a+16b}{5!}x^5+o(x^5) \\
因为f(x)是关于x的5阶无穷小，则 \\
\begin{cases}
1-a-b=0 \\
a+4b=0 \\
a+16b\not=0
\end{cases} \\
求解方程组得 a=-\frac{1}{3} \quad b=\frac{4}{3}
$$

### 6.4 求$f^{(n)}(x_0)$即$f(x)$的n阶导在某一点的值

> 原理 $f(x)的n阶泰勒公式为:f(x_0)+f^{'}(x_0)(x-x_0)+\frac{f^{'}(x_0)}{2!}(x-x_0)^2+\cdots+\frac{f^{(n)}(x_0)}{n!}(x-x_0)^n+o((x-x_0)^n)$
>
> 若已知$f(x)$的展开式为：$f(x_0)+f^{'}(x_0)(x-x_0)+\frac{f^{'}(x_0)}{2!}(x-x_0)^2+\cdots+\frac{f^{(n)}(x_0)}{n!}(x-x_0)^n+o((x-x_0)^n)$
>
> 则$\frac{f^{(n)}(x_0)}{n!}=a_n,即f^{(n)}(x_0)=n!a_n$



例5 $f(x)=(1+x^2)\cdot e^x$,求$f^{(100)}(0)$

1）可以利用莱布尼茨公式求$f(x)的100阶导数$，在带入x=0求值

2）利用麦克劳林公式(x=0)
$$
解：因为求f^{(100)}(0)，那么我们把f(x)展成100阶麦克劳林公式且只关心x^{100}项的系数 \\
f(x)=(1+x^2)(1+x+\cdots+\frac{1}{98!}x^{98}+\cdots+\frac{1}{100!}x^{100}+o(x^{100})) \\
设x^{100}项的系数为a_{100},则 \\
a_{100} = \frac{1}{100!}+\frac{1}{98!} 则 \\
f^{(100)}(0)=a_{100}100!=(\frac{1}{100!}+\frac{1}{98!})100!=1+9900=9901
$$

### 6.5 证明题

例6. 设函数$f(x)在闭区间[-1,1]$上是具有3阶连续导数，且$f(-1)=0,f(1)=1,f^{'}(0)=0$

证明：存在$\xi\in(-1,1),使f^{'''}(\xi)=3$

分析：

1. 证明涉及到二阶及以上的导数，考虑泰勒公式。
2. 
    + 要展成几阶泰勒公式：结论为$f^{'''}(\xi)$,余项为阶，展成2阶泰勒公式即可
    + 在哪一点展开-看哪一点的信息最利于展开
        + 在0出有1阶导的值，适合展开

$$
证明：f(x)在x=0处展开2阶泰勒公式 ，得\\
f(x)=f(0)+f^{'}(0)x+\frac{f^{''}(0)}{2!}x^2+\frac{f^{'''}(\xi)}{3!}x^3(\xi在0及x之间) \\
带入f(-1)=0,f(1)=1,f^{'}(0)=0 \quad得\\
\begin{cases}
f(-1)=0=f(0)+\frac{f^{''}(0)}{2}-\frac{f^{'''}(\xi_1)}{6}(\xi_1\in(-1,0)) \quad (1) \\
f(1)=1=f(0)+\frac{f^{''}(0)}{2}+\frac{f^{'''}(\xi_2)}{6}(\xi_2\in(0,1)) \quad(2)
\end{cases} \\
(2)式-(1)式得 \\
\frac{f^{'''}(\xi_1)+f^{'''}(\xi_2)}{6}=1 即\frac{f^{'''}(\xi_1)+f^{'''}(\xi_2)}{2}=3 \\
令g(x)=f^{'''}(x),x\in[-1,1],则g(x)在[-1,1]上连续 \\
\xi_1\in(-1,0),\xi_2\in(0,1),则 \\
\min\{g(\xi_1),g(\xi_2)\}\le\frac{g(\xi_1)+g(\xi_2)}{2}\le\max\{g(\xi_1),g(\xi_2)\} \\
则由介值定理知 \exists\xi\in(\xi_1,\xi_2)\subset(-1,1),使g(\xi)=3 即\\
f^{'''}(\xi)=3
$$

## 7 后记



> :question:QQ:806797785
>
> :star:文档笔记地址：https://gitee.com/gaogzhen/math

参考：

[1]同济大学数学系.高等数学 第七版 上册[M].北京:高等教育出版社,2014.7.P137~p143.

[2]<a href="https://www.bilibili.com/video/BV1864y1T7Ks">【梨米特】同济七版《高等数学》全程教学视频｜纯干货知识点解析，应该是全网最细｜微积分 | 高数</a>[CP/OL].2020-04-16.p21.
